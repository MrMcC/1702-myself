<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			*{
				margin: 0;padding: 0;
			}
			#son{
				width: 200px;
				height: 200px;
				margin: 0 auto;
				/*transform: rotate(150deg);*/
				
			}
			img{
				width: 100%;height: 100%;	
			}
			#wrap{
				position: absolute;left: 450px;top: 220px;z-index: 2;
			}
			button{
				width: 70px;height: 30px;
				background-color: gainsboro;
				border: 1px solid #000;	
			}
		</style>
<!--		<script src="my_animator.js" type="text/javascript" charset="utf-8"></script>-->
	</head>
	<body>
		<div id="wrap">
			<button id="btn">打开风扇</button>
			<button id="btn1">一档</button>
			<button id="btn2">二挡</button>
			<button id="btn3">三挡</button>
			<button id="btn4">关闭风扇</button>
		</div>
		<div id="son">
			<img src="./img/四叶风扇.png"/>
		</div>
		<script type="text/javascript">
			btn.onclick = function(){
				play(800);
			}
			btn1.onclick = function(){
				play(500);
			}
			btn2.onclick = function(){
				play(300);
			}			
			btn3.onclick = function(){
				play(100);
			}
			btn4.onclick = function(){
				cancelAnimationFrame(id)
			}
			var id;
			function play(duration){
				var div = document.getElementById("son");
				var duration = duration,
					startTime = new Date(),
					p;
				id = requestAnimationFrame(function step(){
					p = Math.min(1, (new Date() - startTime)/duration);
					div.style.transform = `rotateZ(${360 * p}deg)`;
					if(p == 1){
						startTime = new Date();
						p = 0;
					}
					p < 1 && (id = requestAnimationFrame(step));
				});
			}
		</script>
	</body>
</html>
